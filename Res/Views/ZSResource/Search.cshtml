@{
	ViewBag.Title = "查询资源";
	var Items = APBplDef.ZSResourceBpl.GetLevel();
	var TowLevel = new List<SelectListItem>() { };

	foreach (var item in Items.GroupBy(m => m.TowLevel))
	{
		TowLevel.Add(new SelectListItem()
		{
			Text = item.Key,
			Value = item.Key
		});
	}
}
<div class="col-md-10 content-wrapper">
	<div class="row">
		<div class="col-lg-4 ">
			<ul class="breadcrumb">
				<li>
					<i class="fa fa-home"></i>
					<a href="@Url.Action("Index", "Home")">首页</a>
				</li>
				<li><a href="@Url.Action("Index", "ZSResource")">资源</a></li>
				<li class="active">@ViewBag.Title</li>
			</ul>
		</div>
	</div>

	<!-- main -->
	<div class="content">
		<div class="main-header">
			<h2>@ViewBag.Title</h2>
			<em>按资源名称查询或者按资源分类列表</em>
		</div>

		<div class="main-content">

			<!-- widget -->
			<div class="widget">
				<div class="widget-header">
					<h3><i class="fa fa-paperclip"></i> @ViewBag.Title</h3>
					<div class="btn-group widget-header-toolbar">
						<a href="#" title="专注" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
					</div>
				</div>

				<div class="widget-content">
					<!-- Condition -->
					<div class="col-sm-12">
						<form class="pull-right condition">
							@Html.DropDownList("TowLevel", TowLevel, "全部资源类型", new { @class = "multiselect" })
						</form>
					</div>
					<!-- end Condition-->
					<div class="col-sm-12">
						<hr />
					</div>
					<!-- Grid -->
					<div id="table-responsive">
						<table id="bootgrid" class="table table-striped table-hover">
							<thead>
								<tr>
									<th data-column-id="title" data-formatter="link" data-headercs="titlewidth">标题</th>
									<th data-column-id="creator">上传作者</th>
									<th data-column-id="createTime" data-formatter="DateOnly">上传日期</th>
									<th data-formatter="commands" data-headercs="cmdwidth2" data-sortable="false">操作</th>
								</tr>
							</thead>
						</table>
					</div>
					<!-- end Grid-->
				</div>
				<!-- end widget content -->

			</div>
			<!-- end widget -->

		</div>
		<!-- /main-content -->
	</div>
	<!-- /main -->
</div>
@section Css {
	@Styles.Render("~/css/multiselect")
	@Styles.Render("~/css/bootgrid")
}

@section Plugins {
	@Scripts.Render("~/js/multiselect")
	@Scripts.Render("~/js/bootgrid")
}

@section Scripts {
	<script type="text/javascript">
		var canbeAudit =	@(ResSettings.SettingsInSession.CanbeAuditResource?1:0);


	function getGlobalRequest() {
		var theRequest = {};
		var array = $(".condition").serializeArray();
		$.each(array, function (i, field) {
			if (field.value) { theRequest[field.name] = field.value; }
		});
		return theRequest;
	}

	function getGridOptions() {

		return $.extend(true, {}, gridOptions, {

			url: window.location.href,

			formatters: {
				"link": function (column, row) {
					var text = row[column.id], url = '/ZSResource/Details/' + row["id"];
					return "<a href='" + url + "'>" + text + "</a>";
				},
				'commands': function (column, row) {
					var id = row.id;
					return '<div class="btn-group btn-group-xs pull-right">' +
								 '<a class="btn btn-success cmd_edit" data-row-id="' + row.id + '" title="编辑">编辑</a>' +
							 '</div>';
				},
			},

			requestHandler: function (request) { return $.extend(true, request, getGlobalRequest()); },

			labels: {
				search: "关键字搜索"
			},

		});

	}


	$(function () {

		var grid = $("#bootgrid")
				.bootgrid(getGridOptions())
				.on("loaded.rs.jquery.bootgrid", function () {
					grid.find(".cmd_edit").on("click", function (e) {
						var id = $(this).data("row-id");
						window.location.href = '/ZSResource/Edit/' + id;
						}).end()
				});


		$(".multiselect").on("change", function () { grid.bootgrid("reload"); })

	});

	</script>

}